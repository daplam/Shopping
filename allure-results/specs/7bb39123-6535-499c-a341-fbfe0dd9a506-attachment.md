# Test info

- Name: Upload download modify price
- Location: C:\ShoppingBDD\tests\Excel\exceltest.spec.ts:86:5

# Error details

```
Error: expect.toContainText: Error: strict mode violation: getByRole('row') resolved to 7 elements:
    1) <div role="row" class="sc-dmyCSP fwQJth rdt_TableHeadRow">…</div> aka getByRole('row', { name: 'S No ▲ Fruit Name ▲ Color ▲' })
    2) <div id="row-0" role="row" class="sc-jsEeTM itluUR rdt_TableRow">…</div> aka getByRole('row', { name: '350 Yellow 299 Summer' })
    3) <div id="row-1" role="row" class="sc-jsEeTM itluUR rdt_TableRow">…</div> aka getByRole('row', { name: 'Apple Red 345 Winter' })
    4) <div id="row-2" role="row" class="sc-jsEeTM itluUR rdt_TableRow">…</div> aka getByRole('row', { name: 'Papaya Orange 187 Spring' })
    5) <div id="row-3" role="row" class="sc-jsEeTM itluUR rdt_TableRow">…</div> aka getByRole('row', { name: 'Banana Yellow 69 All' })
    6) <div id="row-4" role="row" class="sc-jsEeTM itluUR rdt_TableRow">…</div> aka getByRole('row', { name: 'Kivi Green 399 Winter' })
    7) <div id="row-5" role="row" class="sc-jsEeTM itluUR rdt_TableRow">…</div> aka getByRole('row', { name: 'Orange Orange 199 Summer' })

Call log:
  - expect.toContainText with timeout 5000ms
  - waiting for getByRole('row')

    at C:\ShoppingBDD\tests\Excel\exceltest.spec.ts:118:41
```

# Page snapshot

```yaml
- banner:
  - 'heading "RAHUL SHETTY ACADEMY PRACTISE Note: Data will be reset after page refresh." [level=1]'
- table:
  - rowgroup:
    - row "S No ▲ Fruit Name ▲ Color ▲ Price ▲ Season ▲":
      - columnheader "S No ▲"
      - columnheader "Fruit Name ▲"
      - columnheader "Color ▲"
      - columnheader "Price ▲"
      - columnheader "Season ▲"
  - rowgroup:
    - row "1 350 Yellow 299 Summer":
      - cell "1"
      - cell "350"
      - cell "Yellow"
      - cell "299"
      - cell "Summer"
    - row "2 Apple Red 345 Winter":
      - cell "2"
      - cell "Apple"
      - cell "Red"
      - cell "345"
      - cell "Winter"
    - row "3 Papaya Orange 187 Spring":
      - cell "3"
      - cell "Papaya"
      - cell "Orange"
      - cell "187"
      - cell "Spring"
    - row "4 Banana Yellow 69 All":
      - cell "4"
      - cell "Banana"
      - cell "Yellow"
      - cell "69"
      - cell "All"
    - row "5 Kivi Green 399 Winter":
      - cell "5"
      - cell "Kivi"
      - cell "Green"
      - cell "399"
      - cell "Winter"
    - row "6 Orange Orange 199 Summer":
      - cell "6"
      - cell "Orange"
      - cell "Orange"
      - cell "199"
      - cell "Summer"
- navigation:
  - text: "Rows per page:"
  - combobox "Rows per page:":
    - option "10" [selected]
    - option "15"
    - option "20"
    - option "25"
    - option "30"
  - img
  - text: 1-6 of 6
  - button "First Page" [disabled]
  - button "Previous Page" [disabled]
  - button "Next Page" [disabled]
  - button "Last Page" [disabled]
- button "Download"
- button "Choose File"
```

# Test source

```ts
   18 |
   19 |     if (cellValues.rowNum === -1 || cellValues.colNum === -1) {
   20 |         throw new Error(`Value "${searchValue}" not found in worksheet`);
   21 |     }
   22 |
   23 |     if (change) {
   24 |         const cell = workSheet.getCell(cellValues.rowNum, cellValues.colNum + change.colNum);
   25 |     }
   26 |
   27 |     const cell = workSheet.getCell(cellValues.rowNum, cellValues.colNum) // need to pass the specific row and column
   28 |
   29 |     cell.value = replaceValue // update value
   30 |     await workbook.xlsx.writeFile(excelFile) // save changes
   31 | }
   32 |
   33 | async function readExcel({ worksheet, toSearch }: { worksheet: Worksheet, toSearch: CellValue }): Promise<CellPosition> {
   34 |     // let outputcell = { rowNum: -1, colNum: -1 }
   35 |     let outputcell: CellPosition = { rowNum: -1, colNum: -1 };
   36 |
   37 |     worksheet.eachRow((row, rowNumber) => {
   38 |         row.eachCell((cell, columnNumber) => {
   39 |             if (cell.value === toSearch) {
   40 |                 outputcell.rowNum = rowNumber
   41 |                 outputcell.colNum = columnNumber
   42 |                 console.log(rowNumber + '-' + columnNumber)
   43 |
   44 |             }
   45 |         })
   46 |     })
   47 |     return outputcell
   48 | }
   49 |
   50 |
   51 |
   52 | test('Upload download modify name', async ({ page }) => {
   53 |     const textSearch = 'Mango';
   54 |     const updateValue = 'test';
   55 |     await page.goto("https://rahulshettyacademy.com/upload-download-test/index.html");
   56 |
   57 |
   58 |     await page.getByRole('button', { name: 'Download' }).isVisible()
   59 |
   60 |     const [promiseDownload] = await Promise.all([
   61 |         page.waitForEvent('download'),
   62 |         page.getByRole('button', { name: 'Download' }).click()
   63 |     ]);
   64 |
   65 |     const path = await promiseDownload.path(); // temporal path
   66 |
   67 |     // save specific path
   68 |     await promiseDownload.saveAs('/Users/Daplam/Downloads/download.xlsx');
   69 |     await promiseDownload
   70 |
   71 |     // verify file name
   72 |     await expect(promiseDownload.suggestedFilename()).toContain('download.xlsx');
   73 |
   74 |     await writeExcel({ searchValue: textSearch, replaceValue: updateValue, excelFile: "/Users/Daplam/Downloads/download.xlsx" });
   75 |
   76 |     await page.locator("#fileinput").setInputFiles("/Users/Daplam/Downloads/download.xlsx");
   77 |     await expect(page.getByRole('alert').filter({ hasText: 'Updated Excel Data Successfully.' })).toBeVisible()
   78 |
   79 |     //verify updated value
   80 |     await expect(page.getByText(updateValue)).toBeVisible()
   81 |
   82 |     await page.pause()
   83 | })
   84 |
   85 |
   86 | test('Upload download modify price', async ({ page }) => {
   87 |     const textSearch = 'Mango';
   88 |     const updateValue = '350';
   89 |     await page.goto("https://rahulshettyacademy.com/upload-download-test/index.html");
   90 |
   91 |
   92 |     await page.getByRole('button', { name: 'Download' }).isVisible()
   93 |
   94 |     const [promiseDownload] = await Promise.all([
   95 |         page.waitForEvent('download'),
   96 |         page.getByRole('button', { name: 'Download' }).click()
   97 |     ]);
   98 |
   99 |     const path = await promiseDownload.path(); // temporal path
  100 |
  101 |     // save specific path
  102 |     await promiseDownload.saveAs('/Users/Daplam/Downloads/download.xlsx');
  103 |     await promiseDownload
  104 |
  105 |     // verify file name
  106 |     await expect(promiseDownload.suggestedFilename()).toContain('download.xlsx');
  107 |
  108 |     await writeExcel({ searchValue: textSearch, replaceValue: updateValue, excelFile: "/Users/Daplam/Downloads/download.xlsx", change: { rowNum: 0, colNum: 2 } });
  109 |
  110 |
  111 |     await page.locator("#fileinput").setInputFiles("/Users/Daplam/Downloads/download.xlsx");
  112 |     await expect(page.getByRole('alert').filter({ hasText: 'Updated Excel Data Successfully.' })).toBeVisible()
  113 |     await page.pause()
  114 |
  115 |
  116 |     const textlocator = page.getByText(textSearch);
  117 |     const desiredRow = await page.getByRole('row').filter({ has: textlocator });
> 118 |     await expect(desiredRow.locator("#cell-4-undefined")).toContainText(updateValue);
      |                                         ^ Error: expect.toContainText: Error: strict mode violation: getByRole('row') resolved to 7 elements:
  119 |     await page.pause()
  120 |
  121 | })
```